input {
	file {
		path => ["/var/log/httpd/access_log"]
		type => "apache_access"
	}   
}
filter {
	 if [type] == "apache_access" {
		grok {
		  match => { "message" => "%{COMBINEDAPACHELOG}" }
		}
		geoip {
		  source => "clientip"
		  target => "geoip"
		  database => "/etc/logstash/GeoLiteCity.dat"
		  add_field => [ "[geoip][coordinates]", "%{[geoip][longitude]}" ]
		  add_field => [ "[geoip][coordinates]", "%{[geoip][latitude]}"  ]
		}
		mutate {
		  convert => [ "[geoip][coordinates]", "float"]
		}
	}
	date {
		match => [ "timestamp" , "dd/MMM/yyyy:HH:mm:ss Z" ]
	}
}
